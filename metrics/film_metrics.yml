version: 2

metrics:
  - name: film_rental_frequency
    label: Film Rental Frequency
    model_ref: ref('fact_daily_rentals')
    description: "How often each film is rented"
    calculation_method: count
    expression: inventory_id
    timestamp: rental_day
    time_grains: [day, week, month]
    dimensions:
      - film_id
      - category_id
      - rating

  - name: film_revenue
    label: Revenue by Film
    model_ref: ref('fact_payments')
    description: "Total revenue generated by each film"
    calculation_method: sum
    expression: amount
    timestamp: payment_date
    time_grains: [day, week, month]
    dimensions:
      - film_id
      - category_id
      - rating

  - name: average_film_rating
    label: Average Film Rating
    model_ref: ref('dim_films')
    description: "Average rating for films"
    calculation_method: average
    expression: rental_rate
    dimensions:
      - rating
      - category_id 
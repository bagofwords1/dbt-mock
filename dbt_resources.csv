Resource Type,Name,Path,Description,Additional Info
metrics,film_rental_frequency,metrics/film_metrics.yml,How often each film is rented,"{'label': 'Film Rental Frequency', 'calculation_method': 'count', 'expression': 'inventory_id', 'timestamp': 'rental_day', 'time_grains': ['day', 'week', 'month'], 'dimensions': ['film_id', 'category_id', 'rating'], 'filters': [], 'meta': {}}"
metrics,film_revenue,metrics/film_metrics.yml,Total revenue generated by each film,"{'label': 'Revenue by Film', 'calculation_method': 'sum', 'expression': 'amount', 'timestamp': 'payment_date', 'time_grains': ['day', 'week', 'month'], 'dimensions': ['film_id', 'category_id', 'rating'], 'filters': [], 'meta': {}}"
metrics,average_film_rating,metrics/film_metrics.yml,Average rating for films,"{'label': 'Average Film Rating', 'calculation_method': 'average', 'expression': 'rental_rate', 'timestamp': '', 'time_grains': [], 'dimensions': ['rating', 'category_id'], 'filters': [], 'meta': {}}"
metrics,active_customers,metrics/customer_metrics.yml,Count of active customers,"{'label': 'Active Customers', 'calculation_method': 'count_distinct', 'expression': 'customer_id', 'timestamp': '', 'time_grains': [], 'dimensions': ['city', 'country'], 'filters': [{'field': 'active', 'operator': '=', 'value': '1'}], 'meta': {}}"
metrics,average_customer_spend,metrics/customer_metrics.yml,Average amount spent per customer,"{'label': 'Average Customer Spend', 'calculation_method': 'average', 'expression': 'total_amount_paid', 'timestamp': '', 'time_grains': [], 'dimensions': ['city', 'country'], 'filters': [], 'meta': {}}"
metrics,customer_lifetime_value,metrics/customer_metrics.yml,Total revenue generated per customer,"{'label': 'Customer Lifetime Value', 'calculation_method': 'sum', 'expression': 'total_amount_paid', 'timestamp': '', 'time_grains': [], 'dimensions': ['city', 'country'], 'filters': [], 'meta': {}}"
metrics,total_rental_revenue,metrics/rental_metrics.yml,Total revenue from all rentals,"{'label': 'Total Rental Revenue', 'calculation_method': 'sum', 'expression': 'amount', 'timestamp': 'payment_date', 'time_grains': ['day', 'week', 'month', 'quarter', 'year'], 'dimensions': ['staff_id', 'store_id', 'customer_id'], 'filters': [], 'meta': {}}"
metrics,rental_count,metrics/rental_metrics.yml,Total number of rentals,"{'label': 'Number of Rentals', 'calculation_method': 'sum', 'expression': 'total_rentals', 'timestamp': 'rental_day', 'time_grains': ['day', 'week', 'month', 'quarter', 'year'], 'dimensions': ['store_id'], 'filters': [], 'meta': {}}"
metrics,average_rental_duration,metrics/rental_metrics.yml,Average duration of rentals in days,"{'label': 'Average Rental Duration', 'calculation_method': 'average', 'expression': ""{{ calculate_rental_duration('return_date', 'rental_date') }}"", 'timestamp': 'rental_day', 'time_grains': ['day', 'week', 'month', 'quarter', 'year'], 'dimensions': [], 'filters': [], 'meta': {}}"
models,dim_customers,models/dvdrental/dims/dim_customers.yml,Dimension table for customers with their rental statistics,"{'config': {}, 'meta': {}}"
models,fact_daily_rentals,models/dvdrental/facts/fact_daily_rentals.sql,,"{'sql_content': ""with rental_base as (\n    select * from {{ ref('stg_rentals') }}\n),\n\ndaily_rentals as (\n    select \n        date_trunc('day', rental_date) as rental_day,\n        store_id,\n        count(*) as total_rentals,\n        count(distinct customer_id) as unique_customers,\n        count(distinct inventory_id) as unique_films\n    from rental_base\n    group by 1, 2\n)\n\nselect\n    rental_day,\n    store_id,\n    total_rentals,\n    unique_customers,\n    unique_films\nfrom daily_rentals ""}"
macros,calculate_rental_duration,macros/calculate_rental_duration.sql,,
